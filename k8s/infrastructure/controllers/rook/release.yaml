---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: rook-ceph
spec:
  chart:
    spec:
      chart: rook-ceph
      version: 1.18.2
      sourceRef:
        kind: HelmRepository
        name: rook
  releaseName: rook-ceph
  interval: 10m

---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: rook-ceph-cluster
spec:
  chart:
    spec:
      chart: rook-ceph-cluster
      version: 1.18.2
      sourceRef:
        kind: HelmRepository
        name: rook
  releaseName: rook-ceph-cluster
  interval: 10m
  values:
    cephClusterSpec:
      cephVersion:
        image: quay.io/ceph/ceph:v19.2.3
      mgr:
        modules:
          - name: rook
            enabled: true
      dashboard:
        ssl: false
      storage:
        allowDeviceClassUpdate: false
        allowOsdCrushWeightUpdate: false
        scheduleAlways: false
        onlyApplyOSDPlacement: false
      csi:
        readAffinity:
          enabled: false
        cephfs:
      healthCheck:
        daemonHealth:
        startupProbe:
          mon:
            disabled: false
          mgr:
            disabled: false
          osd:
            disabled: false
    route:
      dashboard:
        host:
          name: ceph.vegapunk.cloud
          path: /
          pathType: PathPrefix
        parentRefs:
          - name: internal
            namespace: gateway
    cephBlockPoolsVolumeSnapshotClass:
      enabled: true
      labels:
        velero.io/csi-volumesnapshot-class: "true"
