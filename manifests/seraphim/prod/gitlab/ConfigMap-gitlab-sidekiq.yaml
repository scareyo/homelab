apiVersion: v1
data:
  cable.yml.erb: "production:\n  url: redis://:<%= ERB::Util::url_encode(File.read(\"/etc/gitlab/redis/redis-password\").strip) %>@gitlab-vk:6379/0\n  \n  id:\n  adapter: redis\n"
  configure: |
    # BEGIN gitlab.scripts.configure.secrets
    set -e
    config_dir="/init-config"
    secret_dir="/init-secrets"
    # required
    for secret in gitaly registry rails-secrets ; do
      mkdir -p "${secret_dir}/${secret}"
      cp -f -v -r -L "${config_dir}/${secret}/." "${secret_dir}/${secret}/"
    done
    # optional
    for secret in redis redis-sentinel minio objectstorage postgres ldap duo omniauth smtp kas pages oauth-secrets mailroom gitlab-exporter microsoft_graph_mailer zoekt clickhouse openbao ; do
      if [ -e "${config_dir}/${secret}" ]; then
        mkdir -p "${secret_dir}/${secret}"
        cp -f -v -r -L "${config_dir}/${secret}/." "${secret_dir}/${secret}/"
      fi
    done
    # END gitlab.scripts.configure.secrets
  database.yml.erb: "\nproduction:\n  main:\n    adapter: postgresql\n    encoding: unicode\n    database: app\n    username: app\n    password: <%= File.read('/etc/gitlab/postgres/psql-password-main').strip.to_json %>\n    host: \"gitlab-pg-rw\"\n    port: 5432\n    connect_timeout: \n    keepalives: \n    keepalives_idle: \n    keepalives_interval: \n    keepalives_count: \n    tcp_user_timeout: \n    application_name: \n    prepared_statements: false\n    database_tasks: true\n    \n    \n  ci:\n    adapter: postgresql\n    encoding: unicode\n    database: app\n    username: app\n    password: <%= File.read('/etc/gitlab/postgres/psql-password-ci').strip.to_json %>\n    host: \"gitlab-pg-rw\"\n    port: 5432\n    connect_timeout: \n    keepalives: \n    keepalives_idle: \n    keepalives_interval: \n    keepalives_count: \n    tcp_user_timeout: \n    application_name: \n    prepared_statements: false\n    database_tasks: false\n    \n    \n"
  gitlab.yml.erb: "production: &base\n  gitlab:\n    host: gitlab.vegapunk.cloud\n    https: true\n    action_cable_allowed_origins: []\n    max_request_duration_seconds: 57\n    impersonation_enabled: \n    application_settings_cache_seconds: 60\n    usage_ping_enabled: true\n    seat_link_enabled: true\n    username_changing_enabled: true\n    issue_closing_pattern: \n    default_theme: \n    default_projects_features:\n      issues: true\n      merge_requests: true\n      wiki: true\n      snippets: true\n      builds: true\n      container_registry: true\n    graphql_timeout: \n    webhook_timeout: \n    trusted_proxies:\n    time_zone: \"UTC\"        \n    email_from: \"gitlab@vegapunk.cloud\"\n    email_display_name: \"GitLab\"\n    email_reply_to: \"noreply@vegapunk.cloud\"\n    email_subject_suffix: \"\"\n  \n  gravatar:\n    plain_url: \n    ssl_url: \n  extra:\n    \n    \n    \n    \n    \n    \n  artifacts:\n    enabled: true\n    object_store:\n      enabled: true\n      remote_directory: gitlab-artifacts\n      proxy_download: true\n      connection:\n        provider: AWS\n        region: us-east-1\n        host: minio.vegapunk.cloud\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\n        path_style: true\n        aws_access_key_id: <%= File.read('/etc/gitlab/minio/accesskey').strip.to_json %>\n        aws_secret_access_key: <%= File.read('/etc/gitlab/minio/secretkey').strip.to_json %>\n  lfs:\n    enabled: true\n    object_store:\n      enabled: true\n      remote_directory: git-lfs\n      proxy_download: true\n      connection:\n        provider: AWS\n        region: us-east-1\n        host: minio.vegapunk.cloud\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\n        path_style: true\n        aws_access_key_id: <%= File.read('/etc/gitlab/minio/accesskey').strip.to_json %>\n        aws_secret_access_key: <%= File.read('/etc/gitlab/minio/secretkey').strip.to_json %>\n  uploads:\n    enabled: true\n    object_store:\n      enabled: true\n      remote_directory: gitlab-uploads\n      proxy_download: true\n      connection:\n        provider: AWS\n        region: us-east-1\n        host: minio.vegapunk.cloud\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\n        path_style: true\n        aws_access_key_id: <%= File.read('/etc/gitlab/minio/accesskey').strip.to_json %>\n        aws_secret_access_key: <%= File.read('/etc/gitlab/minio/secretkey').strip.to_json %>\n  packages:\n    enabled: true\n    object_store:\n      enabled: true\n      remote_directory: gitlab-packages\n      proxy_download: true\n      connection:\n        provider: AWS\n        region: us-east-1\n        host: minio.vegapunk.cloud\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\n        path_style: true\n        aws_access_key_id: <%= File.read('/etc/gitlab/minio/accesskey').strip.to_json %>\n        aws_secret_access_key: <%= File.read('/etc/gitlab/minio/secretkey').strip.to_json %>\n  external_diffs:\n    enabled: false\n    when: \n    object_store:\n      enabled: false\n      remote_directory: gitlab-mr-diffs\n      proxy_download: true\n  terraform_state:\n    enabled: false\n    object_store:\n      enabled: false\n      remote_directory: gitlab-terraform-state\n      proxy_download: true\n  ci_secure_files:\n    enabled: false\n    object_store:\n      enabled: false\n      remote_directory: gitlab-ci-secure-files\n      proxy_download: true\n  dependency_proxy:\n    enabled: false\n    object_store:\n      enabled: false\n      remote_directory: gitlab-dependency-proxy\n      proxy_download: true\n  \n  sentry:\n    enabled: false\n    dsn: \n    clientside_dsn: \n    environment: \n  \n  sidekiq:\n    log_format: json\n  oidc_provider:\n    openid_id_token_expire_in_seconds: 120\n  \n  pages:\n    enabled: false\n    access_control: false\n    artifacts_server: true\n    path: /srv/gitlab/shared/pages\n    host: pages.vegapunk.cloud\n    port: 443\n    https: true\n    secret_file: /etc/gitlab/pages/secret\n    external_http: false\n    external_https: false\n    object_store:\n      enabled: true\n      remote_directory: gitlab-pages\n      connection:\n        provider: AWS\n        region: us-east-1\n        host: minio.vegapunk.cloud\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\n        path_style: true\n        aws_access_key_id: <%= File.read('/etc/gitlab/minio/accesskey').strip.to_json %>\n        aws_secret_access_key: <%= File.read('/etc/gitlab/minio/secretkey').strip.to_json %>\n    local_store:\n      enabled: false\n      path: \n    namespace_in_path: false\n  \n  mattermost:\n    enabled: false\n  ## Registry Integration\n  registry:\n    enabled: true\n    host: registry.vegapunk.cloud\n    api_url: http://gitlab-registry.gitlab.svc:5000\n    key: /etc/gitlab/registry/gitlab-registry.key\n    issuer: gitlab-issuer\n    notification_secret: <%= YAML.load_file(\"/etc/gitlab/registry/notificationSecret\").flatten.first %>\n  gitlab_ci:\n  ldap:\n    enabled: false\n  \n  omniauth:\n    enabled: false\n    sync_profile_from_provider: []\n    sync_profile_attributes: [\"email\"]\n    allow_single_sign_on: [\"saml\"]\n    block_auto_created_users: true\n    auto_link_ldap_user: false\n    auto_link_saml_user: false\n    external_providers: []\n  kerberos:\n    enabled: false\n    keytab: /etc/krb5.keytab\n    use_dedicated_port: false\n    port: 8443\n    https: true\n    simple_ldap_linking_allowed_realms: []\n  \n  duo_auth:\n    enabled: false\n    hostname: \n    integration_key: \n    secret_key: \n  \n  duo_auth:\n    enabled: false\n    hostname: \n    integration_key: \n    secret_key: \n  shared:\n  gitaly:\n    client_path: /home/git/gitaly/bin\n    token: <%= File.read('/etc/gitlab/gitaly/gitaly_token').strip.to_json %>\n  repositories:\n    storages: # You must have at least a `default` storage path.\n      default:\n        path: /var/opt/gitlab/repo\n        gitaly_address: tcp://gitlab-gitaly-0.gitlab-gitaly.gitlab.svc:8075\n      \n  backup:\n    path: \"tmp/backups\"   # Relative paths are relative to Rails.root (default: tmp/backups/)\n  gitlab_kas:\n    enabled: true\n    secret_file: /etc/gitlab/kas/.gitlab_kas_secret\n    external_url: \"wss://kas.vegapunk.cloud\"\n    internal_url: \"grpc://gitlab-kas.gitlab.svc:8153\"\n    \n  \n  \n  \n  # Zoekt secrets are present, load them.\n  zoekt:\n    username_file: /etc/gitlab/zoekt/.gitlab_zoekt_username\n    password_file: /etc/gitlab/zoekt/.gitlab_zoekt_password\n  gitlab_shell:\n    path: /home/git/gitlab-shell/\n    hooks_path: /home/git/gitlab-shell/hooks/\n    upload_pack: true\n    receive_pack: true\n    ssh_port: 22\n  workhorse:\n  git:\n    bin_path: /usr/bin/git\n  webpack:\n  monitoring:\n    ip_whitelist:\n      - \"127.0.0.0/8\"\n      - \"::1/128\"\n    sidekiq_exporter:\n      enabled: true\n      address: \"*\"\n      port: 3807\n      log_enabled: false\n    sidekiq_health_checks:\n      enabled: true\n      address: \"*\"\n      port: 3808\n  \n"
  installation_type: |
    gitlab-helm-chart
  krb5.conf: ""
  redis.action_cable.yml.erb: "production:\n  url: redis://:<%= ERB::Util::url_encode(File.read(\"/etc/gitlab/redis/redis-password\").strip) %>@gitlab-vk:6379/0\n  \n  id:\n"
  resque.yml.erb: "production:\n  url: redis://:<%= ERB::Util::url_encode(File.read(\"/etc/gitlab/redis/redis-password\").strip) %>@gitlab-vk:6379/0\n  \n  id:\n"
  session_store.yml.erb: |
    production:
        session_cookie_token_prefix: ""
  smtp_settings.rb: ""
kind: ConfigMap
metadata:
  labels:
    app: sidekiq
    chart: sidekiq-9.8.2
    heritage: Helm
    release: gitlab
  name: gitlab-sidekiq
  namespace: gitlab
