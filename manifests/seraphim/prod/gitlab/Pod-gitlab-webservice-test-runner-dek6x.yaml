apiVersion: v1
kind: Pod
metadata:
  annotations:
    helm.sh/hook: test
    helm.sh/hook-delete-policy: hook-succeeded,hook-failed,before-hook-creation
  labels:
    app: webservice
    chart: webservice-9.8.2
    heritage: Helm
    release: gitlab
  name: gitlab-webservice-test-runner-dek6x
  namespace: gitlab
spec:
  containers:
    - command:
        - sh
        - /tests/test_login
      image: registry.gitlab.com/gitlab-org/build/cng/gitlab-webservice-ee:v18.8.2
      name: test-runner
      volumeMounts:
        - mountPath: /tests
          name: tests
        - mountPath: /initial_root_password
          name: root-password
          readOnly: true
          subPath: initial_root_password
  restartPolicy: Never
  volumes:
    - configMap:
        name: gitlab-webservice-tests
      name: tests
    - name: root-password
      secret:
        items:
          - key: password
            path: initial_root_password
        secretName: gitlab-gitlab-initial-root-password
